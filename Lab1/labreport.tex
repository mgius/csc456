\documentclass[11pt]{article}

% Use wide margins, but not quite so wide as fullpage.sty
\marginparwidth 0.5in 
\oddsidemargin 0.25in 
\evensidemargin 0.25in 
\marginparsep 0.25in
\topmargin 0.25in 
\textwidth 6in \textheight 8 in
% That's about enough definitions

\usepackage{multirow}
\usepackage{tabularx}
\usepackage{longtable}

\begin{document}
%\hfill\vbox{\hbox{Gius, Mark}
%       \hbox{Cpe 456, Section 01}  
%       \hbox{Lab 1}    
%       \hbox{\today}}\par
%
%\bigskip
%\centerline{\Large\bf Lab 1: Security Audit}\par
%\bigskip
\author{Mark Gius}
\title{Lab 1: Security Audit}
\maketitle

\section{System Description}

The system is a low-powered Atom PC, small form factor 
(it is less than 12" on each side, and about 3" tall), 
with a 320GB hard drive and 2GB of ram.  
The system is located in my bedroom in a house in San Luis Obispo, 
on top of another computer.  It is plugged into a surge protector, 
but not a UPS.  The surge protector is shared with several other computers.
The system has no input devices plugged into it 
(keyboard, mouse, webcam, etc).

The system is connected to the internet via a switch in my bedroom 
that is shared with several other desktops. The bedroom switch connects 
to a shared house switch via a cable that runs along the floor of 
the hallway leading to my bedroom.  The shared workgroup switch 
has connects to a Linksys router running DD-WRT (linux), connected to 
a DSL modem (local ATT affiliate ISP).

\section{Threat Analysis}

\begin{longtable}{| p{1.3in} || p{1in} | p{3.7in} |}
    \hline
    \textbf{Threat} & \multicolumn{2}{l|}{} \\
    \hline
    \endhead

    \hline
    \multicolumn{3}{|r|}{{Continued\ldots}} \\
    \hline
    \endfoot

    \hline 
    \endlastfoot

    \multirow{3}{*}{Power Loss}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & The system is completely unavailable in the event 
                  of a power loss \\
            Integrity 
                & Power loss is well known to cause data corruption \\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            &  Random power outage (or malicious conduct) could cause power loss
               to the system \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            Availability
                & Power outages can be mitigated by attaching the server
                  to a UPS \\
            Integrity
                & Steps can be taken to ensure data integrity, such as 
                  journaling filesystems or battery backed disk cache \\
            \end{tabular} \\
    \hline
    \multirow{3}{*}{Shared Network}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & A malicious or incompetent roommate can use all available
                  resources, limiting system's access. \\
            Confidentiality 
                & Data on shared equipment can be snooped.\\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            & Network on which computer is located is untrusted. \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            Availability
                &  Reasonably sane QoS policies on router reduce competition
                   for network resources. \\
            Confidentiality 
                & All sensitive data is sent and received via encrypted, and
                  possibly authenticated channels (HTTPS, SSL, etc). \\
            \end{tabular} \\
    \hline
    \multirow{3}{*}{Public OpenSSH}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & Compromised accounts could consume system resources or 
                  damage services \\
            Confidentiality 
                & Compromised accounts could grant information to unathorized
                  persons \\
            Integrity 
                & Compromised accounts could modify system configurations 
                  and data \\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            & A user account with a bad password could become compromised and
              allow unathorized access to the system \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            General 
                & OpenSSH is configured to disallow remote "root" login.
                 "sshblackd" script monitors for repeated failed logins
                 (brute force attempts) and adds IPs to a "banned" iptables
                 chain.
                 All admin accounts have reasonably secure passwords. \\
            Confidentiality 
                & Sensitive data is not publically readable via file system 
                  permissions, so compromised non-admin accounts are prevented
                  from accessing restricted data \\
            Integrity
                & Same as above, except read/write \\
            \end{tabular} \\
    \hline
    \multirow{3}{*}{Theft}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & \\
            Confidentiality 
                & \\
            Integrity 
                & \\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            &  \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            General 
                & \\
            Availability
                & \\
            Confidentiality 
                & \\
            Integrity
                & \\
            \end{tabular} \\
    \hline
    \multirow{3}{*}{``Public'' Fileshares}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & \\
            Confidentiality 
                & \\
            Integrity 
                & \\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            &  \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            General 
                & \\
            Availability
                & \\
            Confidentiality 
                & \\
            Integrity
                & \\
            \end{tabular} \\
    \hline
    \multirow{3}{*}{Dynamic DNS}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & \\
            Confidentiality 
                & \\
            Integrity 
                & \\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            &  \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            General 
                & \\
            Availability
                & \\
            Confidentiality 
                & \\
            Integrity
                & \\
            \end{tabular} \\
    \hline
    \multirow{3}{*}{Compromised Roommates}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & \\
            Confidentiality 
                & \\
            Integrity 
                & \\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            &  \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            General 
                & \\
            Availability
                & \\
            Confidentiality 
                & \\
            Integrity
                & \\
            \end{tabular} \\
    \hline
    \multirow{3}{*}{IRC Bot}
        & Goals violated
            & \begin{tabular}{p{1in} p{2.4in}}
            Availability 
                & \\
            Confidentiality 
                & \\
            Integrity 
                & \\
            \end{tabular} \\
        \cline{2-3}
        & Vulnerability 
            &  \\
        \cline{2-3}
        & Controls 
            & \begin{tabular}{p{1in} p{2.4in}} 
            General 
                & \\
            Availability
                & \\
            Confidentiality 
                & \\
            Integrity
                & \\
            \end{tabular} \\
    \hline
%    \multirow{3}{*}{}
%        & Goals violated
%            & \begin{tabular}{p{1in} p{2.4in}}
%            Availability 
%                & \\
%            Confidentiality 
%                & \\
%            Integrity 
%                & \\
%            \end{tabular} \\
%        \cline{2-3}
%        & Vulnerability 
%            &  \\
%        \cline{2-3}
%        & Controls 
%            & \begin{tabular}{p{1in} p{2.4in}} 
%            General 
%                & \\
%            Availability
%                & \\
%            Confidentiality 
%                & \\
%            Integrity
%                & \\
%            \end{tabular} \\
%    \hline

\end{longtable}

\end{document}
